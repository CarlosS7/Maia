#!/usr/bin/env node

var Client = require('../lib/maia-client').MaiaClient;

var client = new Client('ws://127.0.0.1:1337',{
  name: "default-client"
});

client.socket.on('open', function(){
    client.bind('username::accepted', function(json){
        client.logger.debug('Received:', json);
        client.send('test', 'myself');
    });

    var fn = function(event){
        client.send('hola', 'a todos');
        client.logger.debug('Bogus function', event);
    }
    client.subscribe('test', fn);

    setTimeout(function(){
        client.unsubscribe('test', fn);
        process.exit(0);
    }, 10000);
});
